@using CareSync.Application.DTOs.Doctors
@using CareSync.Application.DTOs.Patients
@using CareSync.Web.Admin.Forms
@using Microsoft.AspNetCore.Components.Forms
@using System.Linq

<div class="row">
    <div class="col-md-6">
        <div class="mb-3">
            <label class="form-label">Patient *</label>
            <InputSelect @bind-Value="Model.PatientIdString" class="form-select">
                <option value="">Select patient</option>
                @if (Patients != null)
                {
                    foreach (var patient in Patients.OrderBy(p => p.DisplayName))
                    {
                        <option value="@patient.Id.ToString()">@patient.DisplayName</option>
                    }
                }
            </InputSelect>
            <ValidationMessage For="@(() => Model.PatientIdString)" />
        </div>
    </div>
    <div class="col-md-6">
        <div class="mb-3">
            <label class="form-label">Doctor *</label>
            <InputSelect @bind-Value="Model.DoctorIdString" class="form-select">
                <option value="">Select doctor</option>
                @if (Doctors != null)
                {
                    foreach (var doctor in Doctors.OrderBy(d => d.DisplayName))
                    {
                        <option value="@doctor.Id.ToString()">Dr. @doctor.DisplayName</option>
                    }
                }
            </InputSelect>
            <ValidationMessage For="@(() => Model.DoctorIdString)" />
        </div>
    </div>
</div>

<div class="mb-3">
    <label class="form-label">Chief Complaint *</label>
    <InputTextArea @bind-Value="Model.ChiefComplaint" class="form-control" rows="2" />
    <ValidationMessage For="@(() => Model.ChiefComplaint)" />
</div>

<div class="mb-3">
    <label class="form-label">History of Present Illness</label>
    <InputTextArea @bind-Value="Model.HistoryOfPresentIllness" class="form-control" rows="3" />
</div>

<div class="mb-3">
    <label class="form-label">Physical Examination</label>
    <InputTextArea @bind-Value="Model.PhysicalExamination" class="form-control" rows="3" />
</div>

<div class="row">
    <div class="col-md-6">
        <div class="mb-3">
            <label class="form-label">Assessment</label>
            <InputTextArea @bind-Value="Model.Assessment" class="form-control" rows="3" />
        </div>
    </div>
    <div class="col-md-6">
        <div class="mb-3">
            <label class="form-label">Treatment Plan</label>
            <InputTextArea @bind-Value="Model.TreatmentPlan" class="form-control" rows="3" />
        </div>
    </div>
</div>

<div class="mb-3">
    <label class="form-label">Notes</label>
    <InputTextArea @bind-Value="Model.Notes" class="form-control" rows="3" />
</div>

@code {
    [Parameter] public MedicalRecordFormDto Model { get; set; } = null!;
    [Parameter] public IEnumerable<PatientDto>? Patients { get; set; }
    [Parameter] public IEnumerable<DoctorDto>? Doctors { get; set; }
}
